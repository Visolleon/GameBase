﻿<!DOCTYPE html>
<html>
<head>
    <title>Game Engine</title>
    <!--[if IE]><script type="text/javascript" src="js/excanvas.js"></script><![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <style>
      html, body{
        margin:0;
        padding:0;
      }
    </style>
</head>
<body>
    <canvas id="maingame" height="400" width="300"></canvas>
    <script src="js/gamebase.js" type="text/javascript"></script>
    <script src="js/gamebase.dom.js" type="text/javascript"></script>
    <script type="text/javascript">
        var newGame = new Game({
            id : 'maingame',
            success : function () {
                // do something...
            },
            error : function () {
                alert('Your browser not support canvas.');
            }
        });
        domParse(newGame);
        newGame.start();

        var sound = new Sound('sound/bg.m4a');
        sound.loop = true;
        //sound.play();

        window.onblur = function(e){
            //sound.pause();
        };

        window.onfocus = function(){
            //sound.play();
        };

        Test1();
        Test2();
        Test3();

        document.getElementById('maingame').onclick = function(){
            if(newGame.isFullScreen){
                newGame.cancelFullScreen();
            }
            else{
                newGame.fullScreen();
            }
        };

        function Test3(){
            var rect = new Rect(125, -50, 50, 100, "#FF0000", "#00FF00", 4);
            rect.translate = [100, 140];
            newGame.add(rect);
            (function () {
                var i = 1;
                setInterval(function(){
                    rect.rotate = i++ * 2 * Math.PI / 180;
                }, 30);
            })();

            /*
            var arc = new Arc(160, 180, 50, 0, Math.PI * 2, true, "#ffFF00", "#000", 8);
            arc.alpha = .6;
            newGame.add(arc);

            var line = new Line(20, 60, 230, 60, "#0000FF", 5);
            var line2 = new Line(20, 65, 230, 65, "#FF00FF", 5);
            var line3 = new Line(20, 80, 230, 80, "#00FF00", 5);
            line3.alpha = .6;
            newGame.add(line);
            newGame.add(line2);
            newGame.add(line3);
            */

            var rect2 = new Rect(-25, -25, 50, 50, "#FFFF00", "#000", 5);
            rect2.alpha = .6;
            rect2.translate = [220,260];
            newGame.add(rect2);
            (function () {
                var i = 1;
                setInterval(function(){
                    rect2.rotate = i++ * 2 * Math.PI / 180;
                }, 30);
            })();

            var polygon = new Polygon([[50, 200], [100, 150], [150, 150], [200, 200], [150, 250], [100, 250]], "#00FF00", "#000", 2);
            polygon.translate = [0, 120];
            newGame.add(polygon);
        }

        function Test2(){
            var label = new Label("TEST test 1234");
            label.position = [20, 100];
            label.fontSize = '30px';
            label.font = 'Arial';
            newGame.add(label);
        }

        function Test1(){
            var img = new Bitmap('images/html5.png');
            img.zIndex = 2;
            img.position = [20, 100];
            newGame.add(img);
        
            var no = 1, isplus = true;
            setInterval(function(){
                if(no % 20 == 0) isplus = !isplus;
                
                var step = 0.01
                if(isplus){
                    img.scale[0] += step;
                    img.scale[1] += step;
                    img.alpha -= 0.05;
                }
                else{
                    img.scale[0] -= step;
                    img.scale[1] -= step;
                    img.alpha += 0.05;
                }
                no++;
            }, 30);
        }

        var fps = new Label('FPS:');
        fps.position = [100, 20];
        newGame.add(fps);
        setInterval(function(){
            fps.text = "FPS: " + newGame.FPS;
        }, 500);
    </script>
</body>
</html>
